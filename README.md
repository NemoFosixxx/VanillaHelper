Сейчас я бы руки оторвал тому, кто это писал пол года назад. Надо всё переписать в третий раз :)
